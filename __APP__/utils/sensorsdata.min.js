var e = require("../@babel/runtime/helpers/typeof"), t = {}, i = Array.isArray, r = Object.prototype, n = Array.prototype, a = n.forEach, s = n.indexOf, o = r.toString, u = r.hasOwnProperty, c = n.slice, p = function(e, t, i) {
    if (null == e) return !1;
    var r = {};
    if (a && e.forEach === a) e.forEach(t, i); else if (e.length === +e.length) {
        for (var n = 0, s = e.length; n < s; n++) if (n in e && t.call(i, e[n], n, e) === r) return !1;
    } else for (var o in e) if (u.call(e, o) && t.call(i, e[o], o, e) === r) return !1;
};

function _(e) {
    return null != e && "[object Object]" == o.call(e);
}

var d, l = (d = new Date().getTime(), function(e) {
    return Math.ceil((d = (9301 * d + 49297) % 233280) / 233280 * e);
});

function f() {
    if ("function" == typeof Uint32Array) {
        var e = "";
        if ("undefined" != typeof crypto ? e = crypto : "undefined" != typeof msCrypto && (e = msCrypto), 
        _(e) && e.getRandomValues) {
            var t = new Uint32Array(1);
            return e.getRandomValues(t)[0] / Math.pow(2, 32);
        }
    }
    return l(1e19) / 1e19;
}

function h(e) {
    return p(c.call(arguments, 1), function(t) {
        for (var i in t) void 0 !== t[i] && (e[i] = t[i]);
    }), e;
}

var g = i || function(e) {
    return "[object Array]" === o.call(e);
};

function m(e) {
    return !(!e || !u.call(e, "callee"));
}

function y(e) {
    var t = [];
    return null == e || p(e, function(e) {
        t[t.length] = e;
    }), t;
}

var v = Number.isInteger || function(e) {
    return "number" == typeof e && isFinite(e) && Math.floor(e) === e;
}, b = Number.isSafeInteger || function(e) {
    return v(e) && Math.abs(e) <= Math.pow(2, 53) - 1;
}, $ = {
    each: p,
    isObject: _,
    getRandomBasic: l,
    getRandom: f,
    extend: h,
    extend2Lev: function(e) {
        return p(c.call(arguments, 1), function(t) {
            for (var i in t) void 0 !== t[i] && null !== t[i] && (_(t[i]) && _(e[i]) ? h(e[i], t[i]) : e[i] = t[i]);
        }), e;
    },
    coverExtend: function(e) {
        return p(c.call(arguments, 1), function(t) {
            for (var i in t) void 0 !== t[i] && void 0 === e[i] && (e[i] = t[i]);
        }), e;
    },
    isArray: g,
    isFunction: function(e) {
        try {
            return /^\s*\bfunction\b/.test(e);
        } catch (e) {
            e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
            return !1;
        }
    },
    isArguments: m,
    toArray: function(e) {
        return e ? e.toArray ? e.toArray() : g(e) || m(e) ? c.call(e) : y(e) : [];
    },
    values: y,
    include: function(e, t) {
        var i = !1;
        return null == e ? i : s && e.indexOf === s ? -1 != e.indexOf(t) : (p(e, function(e) {
            if (i || (i = e === t)) return {};
        }), i);
    },
    trim: function(e) {
        return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
    },
    isEmptyObject: function(e) {
        if (_(e)) {
            for (var t in e) if (u.call(e, t)) return !1;
            return !0;
        }
        return !1;
    },
    deepCopy: function(e) {
        var t = {};
        return function e(t, i) {
            for (var r in i) {
                var n = i[r];
                g(n) ? (t[r] = [], e(t[r], n)) : _(n) ? (t[r] = {}, e(t[r], n)) : t[r] = n;
            }
        }(t, e), t;
    },
    isUndefined: function(e) {
        return void 0 === e;
    },
    isString: function(e) {
        return "[object String]" == o.call(e);
    },
    isDate: function(e) {
        return "[object Date]" == o.call(e);
    },
    isBoolean: function(e) {
        return "[object Boolean]" == o.call(e);
    },
    isNumber: function(e) {
        return "[object Number]" == o.call(e) && /[\d\.]+/.test(String(e));
    },
    isJSONString: function(e) {
        try {
            JSON.parse(e);
        } catch (e) {
            e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
            return !1;
        }
        return !0;
    },
    isInteger: v,
    isSafeInteger: b,
    slice: c
}, S = {};

function P(e) {
    e = JSON.stringify(e);
    var i = t._.base64Encode(e);
    return encodeURIComponent(i);
}

S.buildData = function(e) {
    var i = t._, r = {
        distinct_id: t.store.getDistinctId(),
        identities: t.store._state.identities,
        lib: {
            $lib: t.lib_name,
            $lib_method: "code",
            $lib_version: t.lib_version
        },
        properties: {}
    };
    return "track_id_unbind" === e.type && "$UnbindID" === e.event && (r.identities = i.deepCopy(e.unbind_value), 
    delete e.unbind_value), i.extend(r, t.store.getUnionId(), e), i.isObject(e.properties) && !i.isEmptyObject(e.properties) && i.extend(r.properties, e.properties), 
    e.type && "profile" === e.type.slice(0, 7) || (r._track_id = Number(String(f()).slice(2, 5) + String(f()).slice(2, 4) + String(Date.now()).slice(-4)), 
    r.properties = i.extend({}, i.info.properties, t.store.getProps(), i.info.currentProps, r.properties), 
    "track" === e.type && (r.properties.$is_first_day = i.getIsFirstDay()), function(e) {
        if (e && e.properties) {
            var i = t._.getRefPage(), r = t._.getCurrentPageInfo(), n = {
                $referrer: i.route,
                $referrer_title: i.title,
                $title: r.title,
                $url: r.url
            };
            for (var a in !0 === t.para.preset_properties.url_path && (n.$url_path = r.path), 
            n) e.properties.hasOwnProperty(a) || (e.properties[a] = n[a]);
        }
    }(r)), r.properties.$time && i.isDate(r.properties.$time) ? (r.time = 1 * r.properties.$time, 
    delete r.properties.$time) : r.time = 1 * new Date(), i.parseSuperProperties(r.properties), 
    i.searchObjDate(r), i.searchObjString(r), r;
}, S.processData = function(e) {
    return e;
}, S.onceTrackData = function(e) {
    return "data=" + P(e);
}, S.batchTrackData = function(e) {
    var t = Date.now();
    return e.forEach(function(e) {
        e._flush_time = t;
    }), "data_list=" + P(e);
};

var k = {
    getData: function(e) {
        wx.getStorage({
            key: t.para.storage_prepare_data_key,
            complete: function(i) {
                var r = i.data && t._.isArray(i.data) ? i.data : [];
                k.deleteAesData(r), e && e();
            }
        });
    },
    deleteAesData: function(e) {
        var i = [], r = e.length;
        if (r > 0) {
            for (var n = 0; n < r; n++) t._.isObject(e[n]) && i.push(e[n]);
            t.store.mem.mdata = i.concat(t.store.mem.mdata);
        }
    }
}, O = {
    dataHasSend: !0,
    dataHasChange: !1,
    syncStorage: !1,
    failTime: 0,
    init: function() {
        k.getData(O.syncStorageState), O.batchInterval();
    },
    syncStorageState: function() {
        O.syncStorage = !0;
    },
    onAppHide: function() {
        t.para.batch_send && this.batchSend();
    },
    send: function(e) {
        this.dataHasChange = !0, t.store.mem.getLength() >= 500 && (t._.logger.info("数据量存储过大，有异常"), 
        t.store.mem.mdata.shift()), (e = S.processData(e)) && t.store.mem.add(e), t.store.mem.getLength() >= t.para.batch_send.max_length && this.batchSend();
    },
    wxrequest: function(e) {
        if (t._.isArray(e.data) && e.data.length > 0) {
            var i = S.batchTrackData(e.data);
            t._.wxrequest({
                url: t.para.server_url,
                method: "POST",
                dataType: "text",
                data: i,
                success: function() {
                    e.success(e.len);
                },
                fail: function() {
                    e.fail();
                }
            });
        } else e.success(e.len);
    },
    batchSend: function() {
        if (this.dataHasSend) {
            var e, i, r = t.store.mem.mdata;
            (i = (e = r.length >= 100 ? r.slice(0, 100) : r).length) > 0 && (this.dataHasSend = !1, 
            this.wxrequest({
                data: e,
                len: i,
                success: this.batchRemove.bind(this),
                fail: this.sendFail.bind(this)
            }));
        }
    },
    sendFail: function() {
        this.dataHasSend = !0, this.failTime++;
    },
    batchRemove: function(e) {
        t.store.mem.clear(e), this.dataHasSend = !0, this.dataHasChange = !0, this.batchWrite(), 
        this.failTime = 0;
    },
    is_first_batch_write: !0,
    batchWrite: function() {
        var e = this;
        this.dataHasChange && (this.is_first_batch_write && (this.is_first_batch_write = !1, 
        setTimeout(function() {
            e.batchSend();
        }, 1e3)), this.dataHasChange = !1, this.syncStorage && t._.setStorageSync(t.para.storage_prepare_data_key, t.store.mem.mdata));
    },
    batchInterval: function() {
        var e = this;
        !function t() {
            setTimeout(function() {
                e.batchWrite(), t();
            }, 500);
        }(), function i() {
            setTimeout(function() {
                e.batchSend(), i();
            }, t.para.batch_send.send_timeout * Math.pow(2, e.failTime));
        }();
    }
};

function w(e) {
    e._flush_time = Date.now();
    var i = function(e, t) {
        var i = S.onceTrackData(t);
        return -1 !== e.indexOf("?") ? e + "&" + i : e + "?" + i;
    }(t.para.server_url, e);
    t._.wxrequest({
        url: i,
        method: "GET"
    });
}

var C = {
    send: function(e, i) {
        if (!t.para.server_url) return t._.logger.info("error: server_url 不能为空"), !1;
        if (t.current_scene && 1154 === t.current_scene && !t.para.preset_events.moments_page) return !1;
        var r = t.kit.buildData(e);
        r ? (C.debug(r), t.events.emit("send", r), t.para.batch_send ? O.send(r) : w(r)) : t._.logger.info("error: 数据异常 " + r);
    },
    debug: function(e) {
        t._.logger.info(e);
    }
}, I = {
    init_status: !1,
    life_state: {
        app_launched: !1
    },
    plugin: {
        init_list: [],
        uninitialized_list: []
    },
    privacy: {
        enable_data_collect: !1
    },
    mp_hook: {
        data: 1,
        onLoad: 1,
        onShow: 1,
        onReady: 1,
        onPullDownRefresh: 1,
        onShareAppMessage: 1,
        onShareTimeline: 1,
        onReachBottom: 1,
        onPageScroll: 1,
        onResize: 1,
        onTabItemTap: 1,
        onHide: 1,
        onUnload: 1
    }
};

t.popupEmitter = {
    attached: function() {
        return !1;
    }
};

function T() {
    var e;
    return global && global.sensors_data_pre_config && (e = !!global.sensors_data_pre_config.is_compliance_enabled && global.sensors_data_pre_config.is_compliance_enabled), 
    !e || !!I.init_status || !!I.privacy.enable_data_collect;
}

function q(e, i, r) {
    var n = t.autoTrackCustom[r];
    if (e[i]) {
        var a = e[i];
        e[i] = function() {
            !t.para.autoTrackIsFirst || _(t.para.autoTrackIsFirst) && !t.para.autoTrackIsFirst[r] ? (a.apply(this, arguments), 
            n.apply(this, arguments)) : (!0 === t.para.autoTrackIsFirst || _(t.para.autoTrackIsFirst) && t.para.autoTrackIsFirst[r]) && (n.apply(this, arguments), 
            a.apply(this, arguments));
        };
    } else e[i] = function() {
        n.apply(this, arguments);
    };
}

function j(e) {
    var i, r = {}, n = {}, a = e.currentTarget || {}, s = e.target || {};
    if (_(t.para.framework) && _(t.para.framework.taro) && !t.para.framework.taro.createApp && s.id && a.id && s.id !== a.id) return !1;
    var o = a.dataset || {};
    if (i = e.type, r.$element_id = a.id, r.$element_type = o.type, r.$element_content = o.content, 
    r.$element_name = o.name, _(e.event_prop) && (n = e.event_prop), i && A(i)) {
        if (t.para.preset_events && t.para.preset_events.collect_element && !1 === t.para.preset_events.collect_element(arguments[0])) return !1;
        r.$url_path = t._.getCurrentPath(), t._.setPageRefData(r), r = t._.extend(r, n), 
        t.track("$MPClick", r);
    }
}

function x(e, i) {
    var r = e[i];
    e[i] = function() {
        var e = r.apply(this, arguments), i = arguments[0];
        return _(i) && (t.para.preset_events.defer_track ? setTimeout(function() {
            j(i);
        }, 0) : j(i)), e;
    };
}

function A(e) {
    return !!{
        tap: 1,
        longpress: 1,
        longtap: 1
    }[e];
}

function D(e) {
    var i = [];
    if (t.para.autoTrack && t.para.autoTrack.mpClick) {
        i = function(e) {
            var t = I.mp_hook, i = [];
            for (var r in e) "function" != typeof e[r] || t[r] || i.push(r);
            return i;
        }(e), function(e) {
            var i = e.onTabItemTap;
            e.onTabItemTap = function(e) {
                i && i.apply(this, arguments);
                var r = {};
                e && (r.$element_content = e.text), r.$element_type = "tabBar", r.$url_path = t._.getCurrentPath(), 
                t._.setPageRefData(r), t.track("$MPClick", r);
            };
        }(e);
        for (var r = i.length, n = 0; n < r; n++) x(e, i[n]);
    }
}

function U(e) {
    t.para.autoTrack && t.para.autoTrack.pageLeave && function(e) {
        var i = e.onHide;
        e.onHide = function() {
            i && i.apply(this, arguments), t._.sendPageLeave();
        };
        var r = e.onUnload;
        e.onUnload = function() {
            r && r.apply(this, arguments), t._.sendPageLeave();
        };
    }(e), q(e, "onLoad", "pageLoad"), q(e, "onShow", "pageShow"), q(e, "onAddToFavorites", "pageAddFavorites"), 
    "function" == typeof e.onShareAppMessage && t.autoTrackCustom.pageShare(e), "function" == typeof e.onShareTimeline && t.autoTrackCustom.pageShareTimeline(e);
}

t.kit = S, t.mergeStorageData = k, t.saEvent = C, t.sendStrategy = O, t._ = $, t.IDENTITY_KEY = {
    EMAIL: "$identity_email",
    MOBILE: "$identity_mobile"
}, t.usePlugin = function(e, i) {
    if (e && e.info && "miniprogram_abtesting" === e.info.lib_plugin_name) return "function" == typeof e.init && e.init(t, i), 
    !1;
    if (I.init_status) "function" == typeof e.init && e.init(t, i); else {
        var r = {
            target: e,
            para: i
        };
        I.plugin.uninitialized_list.push(r);
    }
}, t.checkPluginInitStatus = function() {
    if (I.plugin.uninitialized_list.length > 0) {
        for (var e in I.plugin.uninitialized_list) {
            var i = I.plugin.uninitialized_list[e];
            i && i.target && "function" == typeof i.target.init && i.target.init(t, i.para);
        }
        I.plugin.uninitialized_list = [];
    }
}, t.enableDataCollect = function() {
    I.privacy.enable_data_collect = !0;
}, t.para = {
    name: "sensors",
    server_url: "",
    send_timeout: 1e3,
    show_log: !1,
    login_id_key: "$identity_login_id",
    allow_amend_share_path: !0,
    max_string_length: 2500,
    datasend_timeout: 3e3,
    source_channel: [],
    autoTrack: {
        appLaunch: !0,
        appShow: !0,
        appHide: !0,
        pageShow: !0,
        pageShare: !0,
        mpClick: !1,
        mpFavorite: !0,
        pageLeave: !1
    },
    autotrack_exclude_page: {
        pageShow: []
    },
    is_persistent_save: {
        share: !1,
        utm: !1
    },
    preset_properties: {
        url_path: !0
    },
    preset_events: {
        moments_page: !1,
        defer_track: !1,
        share_info_use_string: !1
    },
    batch_send: !0,
    storage_store_key: "sensorsdata2015_wechat",
    storage_prepare_data_key: "sensors_mp_prepare_data"
};

var E = "object" == e(E) ? E : {};

E.info = function() {
    if (t.para.show_log && "object" == ("undefined" == typeof console ? "undefined" : e(console)) && console.log) try {
        if (3 === arguments.length) return console.log(arguments[0], arguments[1], arguments[2]);
        if (2 === arguments.length) return console.log(arguments[0], arguments[1]);
        if (1 === arguments.length) return console.log(arguments[0]);
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        console.log(arguments[0]);
    }
}, $.logger = E, t.setPara = function(e) {
    t.para = $.extend2Lev(t.para, e);
    var i = [];
    if ($.isArray(t.para.source_channel)) for (var r = t.para.source_channel.length, n = 0; n < r; n++) -1 === " utm_source utm_medium utm_campaign utm_content utm_term sa_utm ".indexOf(" " + t.para.source_channel[n] + " ") && i.push(t.para.source_channel[n]);
    t.para.source_channel = i, $.isObject(t.para.register) && $.extend($.info.properties, t.para.register), 
    t.para.openid_url || (t.para.openid_url = t.para.server_url.replace(/([^\/])\/(sa)(\.gif){0,1}/, "$1/mp_login")), 
    "number" != typeof t.para.send_timeout && (t.para.send_timeout = 1e3);
    var a = {
        send_timeout: 6e3,
        max_length: 6
    };
    e && e.datasend_timeout || t.para.batch_send && (t.para.datasend_timeout = 1e4), 
    !0 === t.para.batch_send ? t.para.batch_send = $.extend({}, a) : $.isObject(t.para.batch_send) && (t.para.batch_send = $.extend({}, a, t.para.batch_send));
    var s = {
        share: !1,
        utm: !1
    };
    !0 === t.para.is_persistent_save ? (t.para.is_persistent_save = $.extend({}, s), 
    t.para.is_persistent_save.utm = !0) : $.isObject(t.para.is_persistent_save) && (t.para.is_persistent_save = $.extend({}, s, t.para.is_persistent_save)), 
    t.para.server_url ? t.para.preset_properties = $.isObject(t.para.preset_properties) ? t.para.preset_properties : {} : E.info("请使用 setPara() 方法设置 server_url 数据接收地址,详情可查看https://www.sensorsdata.cn/manual/mp_sdk_new.html#112-%E5%BC%95%E5%85%A5%E5%B9%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0");
}, t.getServerUrl = function() {
    return t.para.server_url;
};

var R = [ "$latest_utm_source", "$latest_utm_medium", "$latest_utm_campaign", "$latest_utm_content", "$latest_utm_term", "$latest_sa_utm" ], L = [ "$latest_share_distinct_id", "$latest_share_url_path", "$latest_share_depth", "$latest_share_method" ], F = [ "sensors_share_d", "sensors_share_p", "sensors_share_i", "sensors_share_m" ], M = Date.now(), N = null, B = 0, H = "", V = "", K = "", Q = !1, z = "";

t.lib_version = "1.17.2", t.lib_name = "MiniProgram";

var J = {}, W = [];

$.decodeURIComponent = function(e) {
    var t = "";
    try {
        t = decodeURIComponent(e);
    } catch (i) {
        i = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(i);
        t = e;
    }
    return t;
}, $.encodeDates = function(e) {
    return $.each(e, function(t, i) {
        $.isDate(t) ? e[i] = $.formatDate(t) : $.isObject(t) && (e[i] = $.encodeDates(t));
    }), e;
}, $.formatDate = function(e) {
    function t(e) {
        return e < 10 ? "0" + e : e;
    }
    return e.getFullYear() + "-" + t(e.getMonth() + 1) + "-" + t(e.getDate()) + " " + t(e.getHours()) + ":" + t(e.getMinutes()) + ":" + t(e.getSeconds()) + "." + t(e.getMilliseconds());
}, $.searchObjDate = function(e) {
    $.isObject(e) && $.each(e, function(t, i) {
        $.isObject(t) ? $.searchObjDate(e[i]) : $.isDate(t) && (e[i] = $.formatDate(t));
    });
}, $.formatString = function(e) {
    return e.length > t.para.max_string_length ? (E.info("字符串长度超过限制，已经做截取--" + e), e.slice(0, t.para.max_string_length)) : e;
}, $.searchObjString = function(e) {
    $.isObject(e) && $.each(e, function(t, i) {
        $.isObject(t) ? $.searchObjString(e[i]) : $.isString(t) && (e[i] = $.formatString(t));
    });
}, $.parseSuperProperties = function(e) {
    $.isObject(e) && ($.each(e, function(t, i) {
        if ($.isFunction(t)) try {
            e[i] = t(), $.isFunction(e[i]) && (E.info("您的属性- " + i + " 格式不满足要求，我们已经将其删除"), delete e[i]);
        } catch (t) {
            t = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(t);
            delete e[i], E.info("您的属性- " + i + " 抛出了异常，我们已经将其删除");
        }
    }), $.strip_sa_properties(e));
}, $.unique = function(e) {
    for (var t, i = [], r = {}, n = 0; n < e.length; n++) (t = e[n]) in r || (r[t] = !0, 
    i.push(t));
    return i;
}, $.check = {
    checkKeyword: function(e) {
        return /^((?!^distinct_id$|^original_id$|^device_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_group|^user_tag)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i.test(e);
    },
    ckeckIdLength: function(e) {
        return !(String(e).length > 255 && (E.info("id 长度超过 255 个字符！"), 1));
    }
}, $.strip_sa_properties = function(e) {
    return $.isObject(e) ? ($.each(e, function(t, i) {
        if ($.isArray(t)) {
            var r = [];
            $.each(t, function(e) {
                $.isString(e) ? r.push(e) : E.info("您的数据-", t, "的数组里的值必须是字符串,已经将其删除");
            }), e[i] = r;
        }
        $.isString(t) || $.isNumber(t) || $.isDate(t) || $.isBoolean(t) || $.isArray(t) || (E.info("您的数据 - " + i + ":" + t + " - 格式不满足要求，已经将其删除"), 
        delete e[i]);
    }), e) : e;
}, $.strip_empty_properties = function(e) {
    var t = {};
    return $.each(e, function(e, i) {
        null != e && (t[i] = e);
    }), t;
}, $.utf8Encode = function(e) {
    var t, i, r, n, a = "";
    for (t = i = 0, r = (e = (e + "").replace(/\r\n/g, "\n").replace(/\r/g, "\n")).length, 
    n = 0; n < r; n++) {
        var s = e.charCodeAt(n), o = null;
        s < 128 ? i++ : o = s > 127 && s < 2048 ? String.fromCharCode(s >> 6 | 192, 63 & s | 128) : String.fromCharCode(s >> 12 | 224, s >> 6 & 63 | 128, 63 & s | 128), 
        null !== o && (i > t && (a += e.substring(t, i)), a += o, t = i = n + 1);
    }
    return i > t && (a += e.substring(t, e.length)), a;
}, $.base64Encode = function(e) {
    var t, i, r, n, a, s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", o = 0, u = 0, c = "", p = [];
    if (!e) return e;
    e = $.utf8Encode(e);
    do {
        t = (a = e.charCodeAt(o++) << 16 | e.charCodeAt(o++) << 8 | e.charCodeAt(o++)) >> 18 & 63, 
        i = a >> 12 & 63, r = a >> 6 & 63, n = 63 & a, p[u++] = s.charAt(t) + s.charAt(i) + s.charAt(r) + s.charAt(n);
    } while (o < e.length);
    switch (c = p.join(""), e.length % 3) {
      case 1:
        c = c.slice(0, -2) + "==";
        break;

      case 2:
        c = c.slice(0, -1) + "=";
    }
    return c;
}, $.urlSafeBase64 = function() {
    var e = {
        "+": "-",
        "/": "_",
        "=": "."
    }, t = {
        "-": "+",
        _: "/",
        ".": "="
    };
    return {
        encode: function(t) {
            return t.replace(/[+\/=]/g, function(t) {
                return e[t];
            });
        },
        decode: function(e) {
            return e.replace(/[-_.]/g, function(e) {
                return t[e];
            });
        },
        trim: function(e) {
            return e.replace(/[.=]{1,2}$/, "");
        },
        isBase64: function(e) {
            return /^[A-Za-z0-9+\/]*[=]{0,2}$/.test(e);
        },
        isUrlSafeBase64: function(e) {
            return /^[A-Za-z0-9_-]*[.]{0,2}$/.test(e);
        }
    };
}(), $.btoa = function(e) {
    for (var t, i, r, n, a = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", s = "", o = 0, u = (e = String(e)).length % 3; o < e.length; ) ((i = e.charCodeAt(o++)) > 255 || (r = e.charCodeAt(o++)) > 255 || (n = e.charCodeAt(o++)) > 255) && E.info("Failed to execute 'btoa' : The string to be encoded contains characters outside of the Latin1 range."), 
    s += a.charAt((t = i << 16 | r << 8 | n) >> 18 & 63) + a.charAt(t >> 12 & 63) + a.charAt(t >> 6 & 63) + a.charAt(63 & t);
    return u ? s.slice(0, u - 3) + "===".substring(u) : s;
}, $.urlBase64Encode = function(e) {
    return $.btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g, function(e, t) {
        return String.fromCharCode("0x" + t);
    }));
}, $.rot13obfs = function(e, t) {
    t = "number" == typeof t ? t : 13;
    for (var i = (e = String(e)).split(""), r = 0, n = i.length; r < n; r++) i[r].charCodeAt(0) < 126 && (i[r] = String.fromCharCode((i[r].charCodeAt(0) + t) % 126));
    return i.join("");
}, $.rot13defs = function(e) {
    return e = String(e), $.rot13obfs(e, 113);
}, $.getCurrentPage = function() {
    var e = {};
    try {
        var t = getCurrentPages();
        e = t[t.length - 1];
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info(e);
    }
    return e;
}, $.getCurrentPath = function() {
    var e = "未取到";
    try {
        var t = $.getCurrentPage();
        e = t ? t.route : e;
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info(e);
    }
    return e;
}, $.getIsFirstDay = function() {
    return "object" == e(t.store._state) && "number" == typeof t.store._state.first_visit_day_time && t.store._state.first_visit_day_time > new Date().getTime();
}, $.getCurrentUrl = function(e) {
    var t = $.getCurrentPath(), i = "";
    return $.isObject(e) && e.sensors_mp_encode_url_query && (i = e.sensors_mp_encode_url_query), 
    t ? i ? t + "?" + i : t : "未取到";
}, $.getPath = function(e) {
    return "string" == typeof e ? e.replace(/^\//, "") : "取值异常";
}, t.initialState = {
    queue: [],
    isComplete: !1,
    systemIsComplete: !1,
    storeIsComplete: !1,
    checkIsComplete: function() {
        this.systemIsComplete && this.storeIsComplete && (this.isComplete = !0, this.queue.length > 0 && ($.each(this.queue, function(e) {
            "appLaunch" === e[0] ? t.autoTrackCustom.appLaunch.apply(t.autoTrackCustom, $.slice.call(e[1])) : t[e[0]].apply(t, $.slice.call(e[1]));
        }), this.queue = []));
    }
}, $.getCustomUtmFromQuery = function(e, i, r, n) {
    if (!$.isObject(e)) return {};
    var a = {};
    if (e.sa_utm) for (var s in e) "sa_utm" !== s ? $.include(t.para.source_channel, s) && (a[r + s] = e[s]) : a[n + s] = e[s]; else for (var s in e) -1 === " utm_source utm_medium utm_campaign utm_content utm_term ".indexOf(" " + s + " ") ? $.include(t.para.source_channel, s) && (a[r + s] = e[s]) : a[i + s] = e[s];
    return a;
}, $.getObjFromQuery = function(e) {
    var t = e.split("?"), i = [], r = {};
    return t && t[1] ? ($.each(t[1].split("&"), function(e) {
        (i = e.split("="))[0] && i[1] && (r[i[0]] = i[1]);
    }), r) : {};
}, $.setStorageSync = function(e, t) {
    var i = function() {
        wx.setStorageSync(e, t);
    };
    try {
        i();
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info("set Storage fail --", e);
        try {
            i();
        } catch (e) {
            e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
            E.info("set Storage fail again --", e);
        }
    }
}, $.getStorageSync = function(e) {
    var t = "";
    try {
        t = wx.getStorageSync(e);
    } catch (i) {
        i = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(i);
        try {
            t = wx.getStorageSync(e);
        } catch (e) {
            e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
            E.info("getStorage fail");
        }
    }
    return t;
}, $.getMPScene = function(e) {
    return "number" == typeof e || "string" == typeof e && "" !== e ? e = "wx-" + String(e) : "未取到值";
}, $.objToParam = function(e, t) {
    if ("[object Object]" !== Object.prototype.toString.call(e)) return E.info("请传入有效对象"), 
    "";
    var i = [];
    for (var r in e) if (e.hasOwnProperty(r)) {
        var n = e[r];
        void 0 === n ? i.push(r + "=") : (n = t ? encodeURIComponent(n) : n, i.push(r + "=" + n));
    }
    return i.join("&");
}, $.delObjectKey = function(e) {
    if ("[object Object]" === Object.prototype.toString.call(e)) for (var t = 0; t < F.length; t++) delete e[F[t]]; else E.info("请传入有效对象");
}, $.shareInfoData = function(e) {
    var i = {}, r = {};
    if (t.para.preset_events.share_info_use_string) {
        r = e.query;
        for (var n = 0; n < F.length; n++) {
            if (!r.hasOwnProperty(F[n])) return {};
            r[F[n]] = $.decodeURIComponent(r[F[n]]);
        }
        i = {
            depth: Number(r.sensors_share_d),
            path: r.sensors_share_p || "",
            id: r.sensors_share_i || "",
            method: r.sensors_share_m || ""
        };
    } else {
        if (!e.query.sampshare) return {};
        if (r = $.decodeURIComponent(e.query.sampshare), !$.isJSONString(r)) return {};
        i = {
            depth: (r = JSON.parse(r)).d,
            path: r.p,
            id: r.i,
            method: r.m
        };
    }
    return i;
}, $.setShareInfo = function(e, i) {
    var r = {}, n = {}, a = t.store.getDistinctId(), s = t.store.getFirstId();
    if (e && $.isObject(e.query)) {
        if (r = $.shareInfoData(e), $.isEmptyObject(r)) return {};
        var o = r.depth, u = r.path, c = r.id, p = r.method;
    }
    "string" == typeof c ? (i.$share_distinct_id = c, H = c, n.$latest_share_distinct_id = c) : i.$share_distinct_id = "取值异常", 
    "number" == typeof o ? !H || H !== a && H !== s ? !H || H === a && H === s ? i.$share_depth = "-1" : (i.$share_depth = o + 1, 
    B = o + 1, n.$latest_share_depth = o + 1) : (i.$share_depth = o, B = o, n.$latest_share_depth = o) : i.$share_depth = "-1", 
    "string" == typeof u ? (i.$share_url_path = u, n.$latest_share_url_path = u) : i.$share_url_path = "取值异常", 
    "string" == typeof p ? (i.$share_method = p, n.$latest_share_method = p) : i.$share_method = "取值异常", 
    $.setLatestShare(n);
}, $.getShareInfo = function() {
    if (t.para.preset_events.share_info_use_string) {
        var e = {
            sensors_share_i: t.store.getDistinctId() || "取值异常",
            sensors_share_p: $.getCurrentPath(),
            sensors_share_d: B,
            sensors_share_m: V
        };
        return $.objToParam(e, !0);
    }
    var i = JSON.stringify({
        i: t.store.getDistinctId() || "取值异常",
        p: $.getCurrentPath(),
        d: B,
        m: V
    });
    return "sampshare=" + encodeURIComponent(i);
}, $.detectOptionQuery = function(e) {
    if (!e || !$.isObject(e.query)) return {};
    var i, r, n, a, s = {};
    return s.query = $.extend({}, e.query), "string" == typeof s.query.scene && (i = s.query, 
    r = [ "utm_source", "utm_content", "utm_medium", "utm_campaign", "utm_term", "sa_utm" ].concat(t.para.source_channel), 
    n = new RegExp("(" + r.join("|") + ")%3D", "i"), 1 === (a = Object.keys(i)).length && "scene" === a[0] && n.test(i.scene)) && (s.scene = s.query.scene, 
    delete s.query.scene), e.query.q && e.query.scancode_time && "101" === String(e.scene).slice(0, 3) && (s.q = String(s.query.q), 
    delete s.query.q, delete s.query.scancode_time), s;
}, $.getMixedQuery = function(e) {
    var t = $.detectOptionQuery(e), i = t.scene, r = t.q, n = t.query;
    for (var a in n) n[a] = $.decodeURIComponent(n[a]);
    return i && (i = -1 !== (i = $.decodeURIComponent(i)).indexOf("?") ? "?" + i.replace(/\?/g, "") : "?" + i, 
    $.extend(n, $.getObjFromQuery(i))), r && $.extend(n, $.getObjFromQuery($.decodeURIComponent(r))), 
    n;
}, $.setUtm = function(e, t) {
    var i = {}, r = $.getMixedQuery(e), n = $.getCustomUtmFromQuery(r, "$", "_", "$"), a = $.getCustomUtmFromQuery(r, "$latest_", "_latest_", "$latest_");
    return i.pre1 = n, i.pre2 = a, $.extend(t, n), i;
}, $.setSfSource = function(e, i) {
    !$.isEmptyObject(e.query) && e.query._sfs && (i.$sf_source = e.query._sfs, t.registerApp({
        $latest_sf_source: i.$sf_source
    }));
}, $.setPageSfSource = function(e) {
    try {
        var t = $.getCurrentPage(), i = t ? t.options : "", r = $.deepCopy(i);
        for (var n in r) r[n] = $.decodeURIComponent(r[n]);
        !$.isEmptyObject(r) && r._sfs && (e.$sf_source = r._sfs);
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info(e);
    }
};

try {
    var Z = wx.setNavigationBarTitle;
    Object.defineProperty(wx, "setNavigationBarTitle", {
        get: function() {
            return function(e) {
                var t = $.getCurrentPath();
                e = $.isObject(e) ? e : {}, J[t] = e.title, Z.call(this, e);
            };
        }
    });
} catch (d) {
    d = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(d);
    E.info(d);
}

if ($.setRefPage = function() {
    var e = {
        route: "直接打开",
        title: ""
    };
    try {
        var t = $.getCurrentPage();
        if (t && t.route) {
            var i = t.sensors_mp_url_query ? "?" + t.sensors_mp_url_query : "", r = t.route, n = $.getPageTitle(r);
            e.route = r + i, e.title = n, W.length >= 2 ? (W.shift(), W.push(e)) : W.push(e);
        }
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info(e);
    }
}, $.getRefPage = function() {
    var e = {
        route: "直接打开",
        title: ""
    };
    return W.length > 1 && (e.title = W[0].title, e.route = W[0].route), e;
}, $.getCurrentPageInfo = function() {
    var e = $.getCurrentPage(), t = {
        title: "",
        url: "",
        path: "未取到"
    };
    if (e && e.route) {
        var i = e.sensors_mp_url_query ? "?" + e.sensors_mp_url_query : "";
        t.title = $.getPageTitle(e.route), t.url = e.route + i, t.path = e.route;
    }
    return t;
}, $.setPageRefData = function(e, t, i) {
    var r = $.getRefPage();
    $.isObject(e) && (t ? W.length > 0 && t ? (i = i ? "?" + i : "", e.$referrer = $.getPath(t) + i, 
    e.$referrer_title = $.getPageTitle(t)) : (e.$referrer = "直接打开", e.$referrer_title = "") : (e.$referrer = r.route, 
    e.$referrer_title = r.title));
}, $.getPageTitle = function(e) {
    if ("未取到" === e || !e) return "";
    var t = "";
    try {
        if (__wxConfig) {
            var i = __wxConfig, r = __wxConfig.page || {}, n = r[e] || r[e + ".html"], a = {}, s = {};
            if (i.global && i.global.window && i.global.window.navigationBarTitleText && (a.titleVal = i.global.window.navigationBarTitleText), 
            n && n.window && n.window.navigationBarTitleText && (s.titleVal = n.window.navigationBarTitleText), 
            !s.titleVal && __wxAppCode__) {
                var o = __wxAppCode__[e + ".json"];
                o && o.navigationBarTitleText && (s.titleVal = o.navigationBarTitleText);
            }
            if ($.each(J, function(i, r) {
                if (r === e) return t = i;
            }), 0 === t.length) {
                var u = $.extend(a, s);
                t = u.titleVal || "";
            }
        }
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info(e);
    }
    return t;
}, $.wxrequest = function(e) {
    if ($.compareSDKVersion(z, "2.10.0") >= 0) e.timeout = t.para.datasend_timeout, 
    wx.request(e); else {
        var i = wx.request(e);
        setTimeout(function() {
            $.isObject(i) && $.isFunction(i.abort) && i.abort();
        }, t.para.datasend_timeout);
    }
}, $.getAppInfoSync = function() {
    if (wx.getAccountInfoSync) {
        var e = wx.getAccountInfoSync(), t = e && e.miniProgram ? e.miniProgram : {};
        return {
            appId: t.appId,
            appEnv: t.envVersion,
            appVersion: t.version
        };
    }
    return {};
}, $.getAppId = function() {
    var e = $.getAppInfoSync();
    return e && e.appId ? e.appId : "";
}, $.validId = function(e) {
    return "string" != typeof e && "number" != typeof e || "" === e ? (E.info("输入 ID 类型错误"), 
    !1) : "number" != typeof e || (e = String(e), /^\d+$/.test(e)) ? !!$.check.ckeckIdLength(e) && e : (E.info("输入 ID 类型错误"), 
    !1);
}, $.compareSDKVersion = function(e, t) {
    e = e.split("."), t = t.split(".");
    for (var i = Math.max(e.length, t.length); e.length < i; ) e.push("0");
    for (;t.length < i; ) t.push("0");
    for (var r = 0; r < i; r++) {
        var n = parseInt(e[r]), a = parseInt(t[r]);
        if (n > a) return 1;
        if (n < a) return -1;
    }
    return 0;
}, $.setUpperCase = function(e) {
    return $.isString(e) ? e.toLocaleUpperCase() : e;
}, $.getOpenidNameByAppid = function() {
    var e = $.getAppId(), t = "$identity_mp_openid";
    return e && (t = "$identity_mp_" + e + "_openid"), t;
}, $.info = {
    currentProps: {},
    properties: {
        $lib: "MiniProgram",
        $lib_version: String("1.17.2")
    },
    getSystem: function() {
        var e = this.properties;
        wx.getNetworkType({
            success: function(t) {
                e.$network_type = $.setUpperCase(t.networkType);
            },
            complete: function() {
                wx.getSystemInfo({
                    success: function(t) {
                        var i, r;
                        e.$brand = $.setUpperCase(t.brand), e.$manufacturer = t.brand, e.$model = t.model, 
                        e.$screen_width = Number(t.screenWidth), e.$screen_height = Number(t.screenHeight), 
                        e.$os = "ios" === (r = (i = t.platform).toLowerCase()) ? "iOS" : "android" === r ? "Android" : i, 
                        e.$os_version = t.system.indexOf(" ") > -1 ? t.system.split(" ")[1] : t.system, 
                        z = t.SDKVersion, e.$mp_client_app_version = t.version, e.$mp_client_basic_library_version = z;
                    },
                    complete: function() {
                        var i = new Date().getTimezoneOffset(), r = $.getAppInfoSync();
                        $.isNumber(i) && (e.$timezone_offset = i), r.appId && (e.$app_id = r.appId), r.appVersion && (e.$app_version = r.appVersion), 
                        t.initialState.systemIsComplete = !0, t.initialState.checkIsComplete();
                    }
                });
            }
        });
    }
}, $.eventEmitter = function() {
    this.sub = [];
}, $.eventEmitter.prototype = {
    add: function(e) {
        this.sub.push(e);
    },
    emit: function(e, t) {
        this.sub.forEach(function(i) {
            i.on(e, t);
        });
    }
}, $.eventSub = function(e) {
    t.events.add(this), this._events = [], this.handle = e, this.ready = !1;
}, $.eventSub.prototype = {
    on: function(e, t) {
        if (this.ready) {
            if ($.isFunction(this.handle)) try {
                this.handle(e, t);
            } catch (e) {
                e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
                E.info(e);
            }
        } else this._events.push({
            event: e,
            data: t
        });
    },
    isReady: function() {
        var e = this;
        e.ready = !0, e._events.forEach(function(t) {
            if ($.isFunction(e.handle)) try {
                e.handle(t.event, t.data);
            } catch (e) {
                e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
                E.info(e);
            }
        });
    }
}, t.eventSub = $.eventSub, t.events = new $.eventEmitter(), t.store = {
    storageInfo: null,
    store_queue: [],
    getUUID: function() {
        return Date.now() + "-" + Math.floor(1e7 * f()) + "-" + f().toString(16).replace(".", "") + "-" + String(31242 * f()).replace(".", "").slice(0, 8);
    },
    getStorage: function() {
        return this.storageInfo || (this.storageInfo = t._.getStorageSync(t.para.storage_store_key) || ""), 
        this.storageInfo;
    },
    _state: {},
    mem: {
        mdata: [],
        getLength: function() {
            return this.mdata.length;
        },
        add: function(e) {
            this.mdata.push(e);
        },
        clear: function(e) {
            this.mdata.splice(0, e);
        }
    },
    toState: function(e) {
        var i = null;
        $.isJSONString(e) ? (i = JSON.parse(e)).distinct_id ? this._state = i : this.set("distinct_id", this.getUUID()) : $.isObject(e) && (i = e).distinct_id ? this._state = i : this.set("distinct_id", this.getUUID());
        var r = this._state._first_id || this._state.first_id, n = this._state._distinct_id || this._state.distinct_id, a = this._state.openid, s = (this._state.history_login_id ? this._state.history_login_id : {}).name;
        if (this._state.identities && $.isString(this._state.identities)) {
            var o = JSON.parse($.rot13defs(this._state.identities));
            this._state.identities = o;
        }
        var u, c, p = $.getOpenidNameByAppid();
        if (this._state.identities && $.isObject(this._state.identities) && !$.isEmptyObject(this._state.identities)) {
            var _ = (c = "$mp_openid", (u = $.getAppId()) && (c = "$mp_" + u + "_openid"), c);
            this._state.identities.hasOwnProperty("$mp_id") && (this._state.identities.$identity_mp_id = this._state.identities.$mp_id, 
            delete this._state.identities.$mp_id), this._state.identities.hasOwnProperty("$mp_unionid") && (this._state.identities.$identity_mp_unionid = this._state.identities.$mp_unionid, 
            delete this._state.identities.$mp_unionid), this._state.identities.hasOwnProperty(_) && (this._state.identities[p] = this._state.identities[_], 
            delete this._state.identities[_]), this._state.identities.hasOwnProperty("$identity_anonymous_id") && (this._state.identities.$identity_anonymous_id = r || n);
        } else this._state.identities = {}, this._state.identities.$identity_mp_id = this.getUUID(), 
        this._state.identities.$identity_anonymous_id = r || n;
        if (a && (this._state.identities[p] = a), r) if (s && this._state.identities.hasOwnProperty(s)) {
            if (this._state.identities[s] !== n) {
                for (var d in this._state.identities[s] = n, this._state.identities) this._state.identities.hasOwnProperty(d) && "$identity_mp_id" !== d && d !== s && delete this._state.identities[d];
                this._state.history_login_id.value = n;
            }
        } else {
            for (var d in this._state.identities[t.para.login_id_key] = n, this._state.identities) this._state.identities.hasOwnProperty(d) && "$identity_mp_id" !== d && d !== t.para.login_id_key && delete this._state.identities[d];
            this._state.history_login_id = {
                name: t.para.login_id_key,
                value: n
            };
        } else {
            if (this._state.identities.hasOwnProperty("$identity_login_id") || this._state.identities.hasOwnProperty(s)) for (var d in this._state.identities) this._state.identities.hasOwnProperty(d) && "$identity_mp_id" !== d && "$identity_anonymous_id" !== d && delete this._state.identities[d];
            this._state.history_login_id = {
                name: "",
                value: ""
            };
        }
        this.save();
    },
    getFirstId: function() {
        return this._state._first_id || this._state.first_id;
    },
    getDistinctId: function() {
        return this._state._distinct_id || this._state.distinct_id;
    },
    getUnionId: function() {
        var e = {}, t = this._state._first_id || this._state.first_id, i = this._state._distinct_id || this._state.distinct_id;
        return t && i ? (e.login_id = i, e.anonymous_id = t) : e.anonymous_id = i, e;
    },
    getProps: function() {
        return this._state.props || {};
    },
    setProps: function(e, t) {
        var i = this._state.props || {};
        t ? this.set("props", e) : ($.extend(i, e), this.set("props", i));
    },
    set: function(i, r) {
        var n = {};
        for (var a in "string" == typeof i ? n[i] = r : "object" == e(i) && (n = i), this._state = this._state || {}, 
        n) this._state[a] = n[a], "first_id" === a ? delete this._state._first_id : "distinct_id" === a && (delete this._state._distinct_id, 
        t.events.emit("changeDistinctId"));
        this.save();
    },
    identitiesSet: function(e, i) {
        var r = {};
        switch (e) {
          case "login":
            r.$identity_mp_id = t.store._state.identities.$identity_mp_id, r[t.para.login_id_key] = i;
            break;

          case "logout":
            r.$identity_mp_id = t.store._state.identities.$identity_mp_id;
            break;

          case "identify":
            (r = $.deepCopy(t.store._state.identities)).$identity_anonymous_id = i;
        }
        t.store.set("identities", r);
    },
    change: function(e, t) {
        this._state["_" + e] = t;
    },
    encryptStorage: function() {
        var e = this.getStorage(), i = "data:enc;";
        $.isObject(e) ? e = i + $.rot13obfs(JSON.stringify(e)) : $.isString(e) && -1 === e.indexOf(i) && (e = i + $.rot13obfs(e)), 
        t._.setStorageSync(t.para.storage_store_key, e);
    },
    save: function() {
        var e = $.deepCopy(this._state), i = $.rot13obfs(JSON.stringify(e.identities));
        e.identities = i, delete e._first_id, delete e._distinct_id, t.para.encrypt_storage && (e = "data:enc;" + $.rot13obfs(JSON.stringify(e))), 
        t._.setStorageSync(t.para.storage_store_key, e);
    },
    init: function() {
        var e = this.getStorage();
        if (e) $.isString(e) && -1 !== e.indexOf("data:enc;") && (e = e.substring("data:enc;".length), 
        e = JSON.parse($.rot13defs(e))), this.toState(e); else {
            Q = !0;
            var i = new Date(), r = i.getTime();
            i.setHours(23), i.setMinutes(59), i.setSeconds(60), t.setOnceProfile({
                $first_visit_time: new Date()
            }), this.set({
                distinct_id: this.getUUID(),
                first_visit_time: r,
                first_visit_day_time: i.getTime(),
                identities: {
                    $identity_mp_id: this.getUUID()
                },
                history_login_id: {
                    name: "",
                    value: ""
                }
            });
        }
        t.store.checkStoreInit();
    },
    checkStoreInit: function() {
        I.init_status && (this.store_queue.length > 0 && $.each(this.store_queue, function(e) {
            t[e.method].apply(t, $.slice.call(e.params));
        }), this.store_queue = []);
    }
}, t.setProfile = function(e, i) {
    t.saEvent.send({
        type: "profile_set",
        properties: e
    }, i);
}, t.setOnceProfile = function(e, i) {
    t.saEvent.send({
        type: "profile_set_once",
        properties: e
    }, i);
}, t.appendProfile = function(e, i) {
    if (!$.isObject(e)) return !1;
    $.each(e, function(t, i) {
        $.isString(t) ? e[i] = [ t ] : (delete e[i], E.info("appendProfile属性的值必须是字符串或者数组"));
    }), t.saEvent.send({
        type: "profile_append",
        properties: e
    }, i);
}, t.incrementProfile = function(e, i) {
    if (!$.isObject(e)) return !1;
    var r = e;
    $.isString(e) && ((e = {})[r] = 1), t.saEvent.send({
        type: "profile_increment",
        properties: e
    }, i);
}, t.track = function(e, t, i) {
    this.saEvent.send({
        type: "track",
        event: e,
        properties: t
    }, i);
}, t.identify = function(e, i) {
    if (!T()) return !1;
    if (!I.init_status) return t.store.store_queue.push({
        method: "identify",
        params: arguments
    }), !1;
    if (e = $.validId(e)) {
        var r = t.store.getFirstId();
        !0 === i ? r ? t.store.set("first_id", e) : t.store.set("distinct_id", e) : r ? t.store.change("first_id", e) : t.store.change("distinct_id", e), 
        t.store.identitiesSet("identify", e);
    }
}, t.trackSignup = function(e, i, r, n) {
    var a = t.store.getFirstId() || t.store.getDistinctId();
    t.store.set("distinct_id", e), t.saEvent.send({
        original_id: a,
        distinct_id: e,
        type: "track_signup",
        event: i,
        properties: r
    }, n);
}, t.registerApp = function(e) {
    $.isObject(e) && !$.isEmptyObject(e) && ($.info.currentProps = $.extend($.info.currentProps, e));
}, t.register = function(e) {
    $.isObject(e) && !$.isEmptyObject(e) && t.store.setProps(e);
}, t.clearAllRegister = function() {
    t.store.setProps({}, !0);
}, t.clearAllProps = function(e) {
    var i = t.store.getProps(), r = {};
    $.isArray(e) && ($.each(i, function(t, i) {
        $.include(e, i) || (r[i] = t);
    }), t.store.setProps(r, !0));
}, t.clearAppRegister = function(e) {
    $.isArray(e) && $.each($.info.currentProps, function(t, i) {
        $.include(e, i) && delete $.info.currentProps[i];
    });
}, $.setLatestChannel = function(e) {
    $.isEmptyObject(e) || (function(e, t) {
        var i = !1;
        for (var r in t) e[t[r]] && (i = !0);
        return i;
    }(e, R) && (t.clearAppRegister(R), t.clearAllProps(R)), t.para.is_persistent_save.utm ? t.register(e) : t.registerApp(e));
}, $.setLatestShare = function(e) {
    (e.$latest_share_depth || e.$latest_share_distinct_id || e.$latest_share_url_path || e.$latest_share_method) && (t.clearAppRegister(L), 
    t.clearAllProps(L), t.para.is_persistent_save.share ? t.register(e) : t.registerApp(e));
}, t.login = function(e) {
    if (e = $.validId(e)) {
        var i = t.store.getFirstId(), r = t.store.getDistinctId();
        if (t.store._state.identities.hasOwnProperty(t.para.login_id_key) && e === i) return !1;
        var n = !(t.para.login_id_key === t.store._state.history_login_id.name && t.store._state.history_login_id.value === e);
        n && (t.store._state.identities[t.para.login_id_key] = e), n && (i || t.store.set("first_id", r), 
        t.trackSignup(e, "$SignUp")), n && (t.store.identitiesSet("login", e), t.store.set("history_login_id", {
            name: t.para.login_id_key,
            value: e
        }));
    }
}, t.getAnonymousID = function() {
    if (!$.isEmptyObject(t.store._state)) return t.store._state._first_id || t.store._state.first_id || t.store._state._distinct_id || t.store._state.distinct_id;
    E.info("请先初始化SDK");
}, t.logout = function(e) {
    var i = t.store.getFirstId();
    i ? (t.store.set("first_id", ""), !0 === e ? t.store.set("distinct_id", t.store.getUUID()) : t.store.set("distinct_id", i)) : E.info("没有first_id，logout失败"), 
    t.store.identitiesSet("logout"), t.store.set("history_login_id", {
        name: "",
        value: ""
    });
}, t.getLocation = function() {
    wx.getSetting({
        success: function(e) {
            if (!e.authSetting["scope.userLocation"]) return !1;
            wx.getLocation({
                type: t.para.preset_properties.location.type,
                success: function(e) {
                    t.registerApp({
                        $latitude: e.latitude * Math.pow(10, 6),
                        $longitude: e.longitude * Math.pow(10, 6),
                        $geo_coordinate_system: $.setUpperCase(t.para.preset_properties.location.type)
                    });
                },
                fail: function(e) {
                    E.info("获取位置失败", e);
                }
            });
        }
    });
}, t.openid = {
    getRequest: function(e) {
        wx.login({
            success: function(i) {
                i.code && t.para.appid && t.para.openid_url ? $.wxrequest({
                    url: t.para.openid_url + "&code=" + i.code + "&appid=" + t.para.appid,
                    method: "GET",
                    complete: function(t) {
                        $.isObject(t) && $.isObject(t.data) && t.data.openid ? e(t.data.openid) : e();
                    }
                }) : e();
            }
        });
    },
    getWXStorage: function() {
        var e = t.store.getStorage();
        if (e && $.isObject(e)) return e.openid;
    },
    getOpenid: function(e) {
        if (!t.para.appid) return e(), !1;
        var i = this.getWXStorage();
        i ? e(i) : this.getRequest(e);
    }
}, t.init = function(e) {
    if (!0 === I.init_status) return !1;
    I.init_status = !0, e && $.isObject(e) && t.setPara(e), t.store.init(), t._.info.getSystem(), 
    t.checkPluginInitStatus(), t.para.batch_send && O.init(), t.initialState.storeIsComplete = !0, 
    t.initialState.checkIsComplete(), function() {
        if (!I.life_state.app_launched) {
            var e = wx.getLaunchOptionsSync() || {};
            t.autoTrackCustom.appLaunch(e);
        }
    }();
}, t.getPresetProperties = function() {
    if ($.info && $.info.properties && $.info.properties.$lib) {
        var e = {};
        $.each($.info.currentProps, function(t, i) {
            0 === i.indexOf("$") && (e[i] = t);
        });
        var i = {
            $url_path: $.getCurrentPath(),
            $is_first_day: $.getIsFirstDay(),
            $is_first_time: Q
        }, r = $.extend(e, i, $.info.properties, t.store.getProps());
        return delete r.$lib, r;
    }
    return {};
}, t.setOpenid = function(e, i) {
    if (!(e = $.validId(e))) return !1;
    if (!T()) return !1;
    if (!I.init_status) return t.store.store_queue.push({
        method: "setOpenid",
        params: arguments
    }), !1;
    i && console.log("%c 当前版本 setOpenid 接口 已不支持传入第二个参数", "color:#F39C12;font-size: 14px;"), 
    t.store.set("openid", e), t.identify(e, !0);
    var r = $.getOpenidNameByAppid();
    t.store._state.identities[r] = e, t.store.save();
}, t.unsetOpenid = function(e) {
    var i = $.validId(e);
    if (!i) return !1;
    t.store._state.openid === i && t.store.set("openid", "");
    var r = $.getOpenidNameByAppid();
    t.store._state.identities.hasOwnProperty(r) && i === t.store._state.identities[r] && (delete t.store._state.identities[r], 
    t.store.save());
}, t.setUnionid = function(e) {
    var i = $.validId(e);
    i && (t.store._state.identities.$identity_mp_unionid = i, t.store.save());
}, t.unsetUnionid = function(e) {
    var i = $.validId(e);
    if (i && t.store._state.identities.hasOwnProperty("$identity_mp_unionid") && i === t.store._state.identities.$identity_mp_unionid) {
        var r = $.getOpenidNameByAppid();
        t.store._state.identities.hasOwnProperty(r) && (delete t.store._state.identities[r], 
        delete t.store._state.openid, t.store.save()), delete t.store._state.identities.$identity_mp_unionid, 
        t.store.save();
    }
}, t.initWithOpenid = function(e, i) {
    (e = e || {}).appid && (t.para.appid = e.appid), t.openid.getOpenid(function(r) {
        r && t.setOpenid(r, e.isCoverLogin), i && $.isFunction(i) && i(r), t.init(e);
    });
}, t.bind = function(e, i) {
    if ($.isNumber(i)) {
        if ($.isInteger(i) && !1 === $.isSafeInteger(i)) return E.info("Value must be String"), 
        !1;
        i = String(i);
    }
    if (!$.isString(e)) return E.info("Key must be String"), !1;
    if (!$.check.checkKeyword(e) || "$identity_anonymous_id" === e || "$mp_id" === e || "$identity_mp_id" === e || "$mp_openid" === e || "$identity_mp_openid" === e || "$identity_mp_unionid" === e || "$mp_unionid" === e || "$identity_login_id" === e || e === t.para.login_id_key) {
        var r = "Key [" + e + "] is invalid";
        return E.info(r), !1;
    }
    return i && "" !== i ? $.isString(i) ? $.check.ckeckIdLength(i) ? (t.store._state.identities[e] = i, 
    t.store.save(), void t.saEvent.send({
        type: "track_id_bind",
        event: "$BindID"
    })) : (r = "Value [" + i + "] is beyond the maximum length 255", E.info(r), !1) : (E.info("Value must be String"), 
    !1) : (E.info("Value is empty or null"), !1);
}, t.unbind = function(e, i) {
    if ($.isNumber(i)) {
        if ($.isInteger(i) && !1 === $.isSafeInteger(i)) return E.info("Value must be String"), 
        !1;
        i = String(i);
    }
    if (!$.isString(e)) return E.info("Key must be String"), !1;
    if (!$.check.checkKeyword(e) || "$identity_anonymous_id" === e || "$mp_id" === e || "$identity_mp_id" === e || "$mp_openid" === e || "$identity_mp_openid" === e || "$identity_mp_unionid" === e || "$mp_unionid" === e || "$identity_login_id" === e || e === t.para.login_id_key) {
        var r = "Key [" + e + "] is invalid";
        return E.info(r), !1;
    }
    if (!i || "" === i) return E.info("Value is empty or null"), !1;
    if (!$.isString(i)) return E.info("Value must be String"), !1;
    if (!$.check.ckeckIdLength(i)) return r = "Value [" + i + "] is beyond the maximum length 255", 
    E.info(r), !1;
    t.store._state.identities.hasOwnProperty(e) && i === t.store._state.identities[e] && (delete t.store._state.identities[e], 
    t.store.save());
    var n = {};
    n[e] = i, t.saEvent.send({
        type: "track_id_unbind",
        event: "$UnbindID",
        unbind_value: n
    });
}, t.setWebViewUrl = function(e, i) {
    if (!$.isString(e) || "" === e) return E.info("error:请传入正确的 URL 格式"), !1;
    if (!/^http(s)?:\/\//.test(e)) return E.info("warning: 请传入正确的 URL 格式"), !1;
    var r = /([^?#]+)(\?[^#]*)?(#.*)?/.exec(e);
    if (!r) return !1;
    var n, a = r[1] || "", s = r[2] || "", o = r[3] || "", u = "", c = t.store.getDistinctId() || "", p = t.store.getFirstId() || "";
    $.urlSafeBase64 && $.urlSafeBase64.encode ? c = c ? $.urlSafeBase64.trim($.urlSafeBase64.encode($.urlBase64Encode(c))) : "" : this._.rot13obfs && (c = c ? $.rot13obfs(c) : ""), 
    c = encodeURIComponent(c);
    var _ = p ? "f" + c : "d" + c;
    return i ? (n = o.indexOf("_sasdk"), u = o.indexOf("?") > -1 ? n > -1 ? a + s + "#" + o.substring(1, n) + "_sasdk=" + _ : a + s + "#" + o.substring(1) + "&_sasdk=" + _ : a + s + "#" + o.substring(1) + "?_sasdk=" + _) : (n = s.indexOf("_sasdk"), 
    u = /^\?(\w)+/.test(s) ? n > -1 ? a + s.replace(/(_sasdk=)([^&]*)/gi, "_sasdk=" + _) + o : a + "?" + s.substring(1) + "&_sasdk=" + _ + o : a + "?" + s.substring(1) + "_sasdk=" + _ + o), 
    u;
}, $.each([ "setProfile", "setOnceProfile", "track", "quick", "incrementProfile", "appendProfile", "login", "logout", "registerApp", "register", "clearAllRegister", "clearAllProps", "clearAppRegister", "bind", "unbind", "unsetOpenid", "setUnionid", "unsetUnionid" ], function(e) {
    var i = t[e];
    t[e] = function() {
        if (!T()) return !1;
        t.initialState.isComplete ? i.apply(t, arguments) : t.initialState.queue.push([ e, arguments ]);
    };
}), $.setQuery = function(e, t) {
    if (e && $.isObject(e) && !$.isEmptyObject(e)) {
        var i = [];
        return $.each(e, function(e, r) {
            "q" === r && $.isString(e) && 0 === e.indexOf("http") || (t ? i.push(r + "=" + e) : i.push(r + "=" + $.decodeURIComponent(e)));
        }), i.join("&");
    }
    return "";
}, $.getUtmFromPage = function() {
    var e = {};
    try {
        var t = $.getCurrentPage(), i = $.deepCopy(t.options);
        for (var r in i) i[r] = $.decodeURIComponent(i[r]);
        e = $.getCustomUtmFromQuery(i, "$", "_", "$");
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info(e);
    }
    return e;
}, $.sendPageLeave = function() {
    var e = {}, i = "";
    try {
        i = (e = $.getCurrentPage()) ? e.route : "";
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        E.info(e);
    }
    if (M >= 0 && "" !== i) {
        var r = {}, n = $.getPageTitle(i), a = (Date.now() - M) / 1e3;
        (isNaN(a) || a < 0) && (a = 0), r.$url_query = e.sensors_mp_url_query ? e.sensors_mp_url_query : "", 
        r.$url_path = i, r.$title = n, r.event_duration = a, t.track("$MPPageLeave", r), 
        M = -1;
    }
}, t.autoTrackCustom = {
    trackCustom: function(e, i, r) {
        var n = t.para.autoTrack[e], a = "";
        t.para.autoTrack && n && ("function" == typeof n ? (a = n(), $.isObject(a) && $.extend(i, a)) : $.isObject(n) && ($.extend(i, n), 
        t.para.autoTrack[e] = !0), t.track(r, i));
    },
    appLaunch: function(i, r) {
        if ("object" != e(this) || this.trackCustom || (this[t.para.name] = t), !T()) return !1;
        if (!t.initialState.isComplete) return t.initialState.queue.push([ "appLaunch", arguments ]), 
        I.life_state.app_launched = !0, !1;
        I.life_state.app_launched = !0;
        var n = {};
        if (i && i.scene ? (K = i.scene, t.current_scene = K, n.$scene = $.getMPScene(i.scene)) : n.$scene = "未取到值", 
        i && i.scene && 1010 === i.scene && i.query && (i.query.sampshare && delete i.query.sampshare, 
        $.delObjectKey(i.query)), i && i.path && (n.$url_path = $.getPath(i.path), n.$title = $.getPageTitle(i.path), 
        i.query && $.isObject(i.query))) {
            var a = $.setQuery(i.query);
            a = a ? "?" + a : "", n.$url = n.$url_path + a;
        }
        $.setShareInfo(i, n);
        var s = $.setUtm(i, n);
        Q ? (n.$is_first_time = !0, $.isEmptyObject(s.pre1) || t.setOnceProfile(s.pre1)) : n.$is_first_time = !1, 
        $.setLatestChannel(s.pre2), $.setSfSource(i, n), t.registerApp({
            $latest_scene: n.$scene
        }), n.$url_query = $.setQuery(i.query), $.setPageRefData(n), r ? (n = $.extend(n, r), 
        t.track("$MPLaunch", n)) : t.para.autoTrack && t.para.autoTrack.appLaunch && t.autoTrackCustom.trackCustom("appLaunch", n, "$MPLaunch");
    },
    appShow: function(e, i) {
        var r = {};
        N = new Date().getTime(), e && e.scene ? (K = e.scene, t.current_scene = K, r.$scene = $.getMPScene(e.scene)) : r.$scene = "未取到值", 
        e && e.scene && 1010 === e.scene && e.query && (e.query.sampshare && delete e.query.sampshare, 
        $.delObjectKey(e.query)), e && e.path && (r.$url_path = $.getPath(e.path), r.$title = $.getPageTitle(e.path)), 
        !$.isObject(t.para.preset_properties.location) || "wgs84" !== t.para.preset_properties.location.type && "gcj02" !== t.para.preset_properties.location.type || t.getLocation(), 
        $.setShareInfo(e, r);
        var n = $.setUtm(e, r);
        $.setLatestChannel(n.pre2), $.setSfSource(e, r), t.registerApp({
            $latest_scene: r.$scene
        }), r.$url_query = $.setQuery(e.query), $.setPageRefData(r, e.path, r.$url_query), 
        e && e.path && (r.$url = e.path + (r.$url_query ? "?" + r.$url_query : "")), i ? (r = $.extend(r, i), 
        t.track("$MPShow", r)) : t.para.autoTrack && t.para.autoTrack.appShow && t.autoTrackCustom.trackCustom("appShow", r, "$MPShow");
    },
    appHide: function(e) {
        var i = new Date().getTime(), r = {};
        r.$url_path = $.getCurrentPath(), N && i - N > 0 && (i - N) / 36e5 < 24 && (r.event_duration = (i - N) / 1e3), 
        $.setPageRefData(r), e ? (r = $.extend(r, e), t.track("$MPHide", r)) : t.para.autoTrack && t.para.autoTrack.appHide && t.autoTrackCustom.trackCustom("appHide", r, "$MPHide"), 
        O.onAppHide();
    },
    pageLoad: function(e) {
        K && 1010 === K && e && (e.sampshare && delete e.sampshare, $.delObjectKey(e)), 
        e && $.isObject(e) && (this.sensors_mp_url_query = $.setQuery(e), this.sensors_mp_encode_url_query = $.setQuery(e, !0));
    },
    pageShow: function() {
        M = Date.now();
        var e = {}, i = $.getCurrentPath(), r = $.getPageTitle(i);
        $.setRefPage(), e.$url_path = i, e.$url_query = this.sensors_mp_url_query ? this.sensors_mp_url_query : "", 
        e = $.extend(e, $.getUtmFromPage()), $.setPageRefData(e), $.setPageSfSource(e), 
        r && (e.$title = r), t.para.onshow ? t.para.onshow(t, i, this) : $.isObject(t.para.autotrack_exclude_page) && $.isArray(t.para.autotrack_exclude_page.pageShow) && -1 !== t.para.autotrack_exclude_page.pageShow.indexOf(i) || t.autoTrackCustom.trackCustom("pageShow", e, "$MPViewScreen");
    },
    pageShare: function(i) {
        var r = i.onShareAppMessage;
        i.onShareAppMessage = function() {
            V = "转发消息卡片";
            var i = r.apply(this, arguments);
            if (t.para.autoTrack && t.para.autoTrack.pageShare) {
                var n = {
                    $url_path: $.getCurrentPath(),
                    $share_depth: B,
                    $share_method: V
                };
                $.setPageRefData(n), t.autoTrackCustom.trackCustom("pageShare", n, "$MPShare");
            }
            return t.para.allow_amend_share_path && ("object" != e(i) && ((i = {}).path = $.getCurrentUrl(this)), 
            "object" != e(i) || void 0 !== i.path && "" !== i.path || (i.path = $.getCurrentUrl(this)), 
            "object" == e(i) && "string" == typeof i.path && (-1 === i.path.indexOf("?") ? i.path = i.path + "?" : "&" !== i.path.slice(-1) && (i.path = i.path + "&")), 
            i.path = i.path + $.getShareInfo()), i;
        };
    },
    pageShareTimeline: function(i) {
        var r = i.onShareTimeline;
        i.onShareTimeline = function() {
            V = "朋友圈分享";
            var i = r.apply(this, arguments);
            if (t.para.autoTrack && t.para.autoTrack.pageShare) {
                var n = {
                    $url_path: $.getCurrentPath(),
                    $share_depth: B,
                    $share_method: V
                };
                $.setPageRefData(n), t.autoTrackCustom.trackCustom("pageShare", n, "$MPShare");
            }
            return t.para.allow_amend_share_path && ("object" != e(i) && (i = {}), "object" == e(i) && void 0 === i.query && (i.query = ""), 
            "object" == e(i) && "string" == typeof i.query && "" !== i.query && "&" !== i.query.slice(-1) && (i.query = i.query + "&"), 
            i.query = i.query + $.getShareInfo()), i;
        };
    },
    pageAddFavorites: function() {
        var e = {};
        e.$url_path = $.getCurrentPath(), t.para.autoTrack && t.para.autoTrack.mpFavorite && t.autoTrackCustom.trackCustom("mpFavorite", e, "$MPAddFavorites");
    }
}, t.quick = function() {
    var e = arguments[0], i = arguments[1], r = arguments[2], n = $.isObject(r) ? r : {};
    if ("getAnonymousID" === e) {
        if (!$.isEmptyObject(t.store._state)) return t.store._state._first_id || t.store._state.first_id || t.store._state._distinct_id || t.store._state.distinct_id;
        E.info("请先初始化SDK");
    } else "appLaunch" === e || "appShow" === e ? i ? t.autoTrackCustom[e](i, n) : E.info("App的launch和show，在sensors.quick第二个参数必须传入App的options参数") : "appHide" === e && (n = $.isObject(i) ? i : {}, 
    t.autoTrackCustom[e](n));
}, t.appLaunch = function(e, i) {
    var r = {};
    e && e.scene ? (K = e.scene, t.current_scene = K, r.$scene = $.getMPScene(e.scene)) : r.$scene = "未取到值", 
    e && e.scene && 1010 === e.scene && e.query && (e.query.sampshare && delete e.query.sampshare, 
    $.delObjectKey(e.query)), e && e.path && (r.$url_path = $.getPath(e.path), r.$title = $.getPageTitle(e.path)), 
    $.setShareInfo(e, r);
    var n = $.setUtm(e, r);
    Q ? (r.$is_first_time = !0, $.isEmptyObject(n.pre1) || t.setOnceProfile(n.pre1)) : r.$is_first_time = !1, 
    $.setLatestChannel(n.pre2), $.setSfSource(e, r), t.registerApp({
        $latest_scene: r.$scene
    }), r.$url_query = $.setQuery(e.query), r.$url = e.path + (r.$url_query ? "?" + r.$url_query : ""), 
    $.setPageRefData(i), $.isObject(i) && (r = $.extend(r, i)), t.track("$MPLaunch", r);
}, t.appShow = function(e, i) {
    var r = {};
    N = new Date().getTime(), e && e.scene ? (K = e.scene, t.current_scene = K, r.$scene = $.getMPScene(e.scene)) : r.$scene = "未取到值", 
    e && e.scene && 1010 === e.scene && e.query && (e.query.sampshare && delete e.query.sampshare, 
    $.delObjectKey(e.query)), e && e.path && (r.$url_path = $.getPath(e.path), r.$title = $.getPageTitle(e.path)), 
    !$.isObject(t.para.preset_properties.location) || "wgs84" !== t.para.preset_properties.location.type && "gcj02" !== t.para.preset_properties.location.type || t.getLocation(), 
    $.setShareInfo(e, r);
    var n = $.setUtm(e, r);
    $.setLatestChannel(n.pre2), $.setSfSource(e, r), t.registerApp({
        $latest_scene: r.$scene
    }), r.$url_query = $.setQuery(e.query), e && e.path && (r.$url = e.path + (r.$url_query ? "?" + r.$url_query : "")), 
    $.setPageRefData(r, e.path, r.$url_query), $.isObject(i) && (r = $.extend(r, i)), 
    t.track("$MPShow", r);
}, t.appHide = function(e) {
    var i = new Date().getTime(), r = {};
    r.$url_path = $.getCurrentPath(), N && i - N > 0 && (i - N) / 36e5 < 24 && (r.event_duration = (i - N) / 1e3), 
    $.setPageRefData(r), $.isObject(e) && (r = $.extend(r, e)), t.track("$MPHide", r), 
    O.onAppHide();
}, t.pageShow = function(e) {
    var i = {}, r = $.getCurrentPath(), n = $.getPageTitle(r), a = $.getCurrentPage();
    $.setRefPage(), n && (i.$title = n), i.$url_path = r, i.$url_query = a.sensors_mp_url_query ? a.sensors_mp_url_query : "", 
    i = $.extend(i, $.getUtmFromPage()), $.setPageSfSource(i), $.setPageRefData(i), 
    $.isObject(e) && (i = $.extend(i, e)), t.track("$MPViewScreen", i);
}, function() {
    var e = App;
    App = function(i) {
        i[t.para.name] = t, e.apply(this, arguments);
    }, wx.onAppShow(function(e) {
        if (!I.life_state.app_launched) {
            var i = wx.getLaunchOptionsSync() || {};
            t.autoTrackCustom.appLaunch(i);
        }
        t.autoTrackCustom.appShow(e);
    }), wx.onAppHide(function() {
        t.autoTrackCustom.appHide();
    });
}(), function() {
    var e = Page;
    Page = function(t) {
        try {
            t || (t = {}), D(t), U(t), e.apply(this, arguments);
        } catch (t) {
            t = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(t);
            e.apply(this, arguments);
        }
    };
    var t = Component;
    Component = function(e) {
        try {
            e || (e = {}), e.methods || (e.methods = {}), D(e.methods), U(e.methods), t.apply(this, arguments);
        } catch (e) {
            e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
            t.apply(this, arguments);
        }
    };
}(), global && global.sensors_data_pre_config) {
    var Y = global.sensors_data_pre_config.login_id_key;
    Y && $.isString(Y) && $.check.checkKeyword(Y) && "$identity_anonymous_id" !== Y && "$mp_id" !== Y && "$identity_mp_id" !== Y && "$identity_mp_unionid" !== Y && "$mp_unionid" !== Y && "$identity_mp_openid" !== Y && "$mp_openid" !== Y ? t.para.login_id_key = Y : E.info("设置自定义登录 ID 失败");
}

module.exports = t;